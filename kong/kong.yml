_format_version: "3.0"
_transform: true

services:
  - name: auth-ms
    url: http://auth-ms:8080
    routes:
      - name: auth-login-route
        paths:
          - /auth/login
        strip_path: false
      - name: auth-register-route
        paths:
          - /auth/register
        strip_path: false
      - name: auth-me-route
        paths:
          - /auth/me
        strip_path: false
        plugins:
          - name: jwt
            config:
              claims_to_verify:
                - exp
              key_claim_name: iss
    plugins:
      - name: rate-limiting
        config:
          minute: 20
          policy: local

  - name: video-ms
    url: http://video-ms:8081
    routes:
      - name: video-route
        paths:
          - /videos
        strip_path: false
    plugins:
      - name: jwt
        config:
          claims_to_verify:
            - exp
          key_claim_name: iss
      - name: rate-limiting
        config:
          minute: 10
          policy: local

consumers:
  - username: hackathon-auth
